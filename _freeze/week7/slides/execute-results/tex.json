{
  "hash": "f2b0510e1649c3d16eb93e225b05d5bc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: ETC3550/ETC5550 Applied forecasting\nauthor: \"Week 7: Seasonal exponential smoothing\"\nformat:\n  presentation-beamer:\n    knitr:\n      opts_chunk:\n        dev: \"cairo_pdf\"\n    pdf-engine: pdflatex\n    fig-width: 7.5\n    fig-height: 3.5\n    include-in-header: ../header.tex\n    keep_tex: yes\n---\n\n\n\n\n## ETS models\n\n\\begin{block}{}\n\\hspace*{-0.25cm}\\begin{tabular}{l@{}p{2.3cm}@{}c@{}l}\n\\alert{General n\\rlap{otation}}\n    &                                        & ~E T S~           & ~:\\hspace*{0.3cm}\\textbf{E}xponen\\textbf{T}ial \\textbf{S}moothing \\\\ [-0.2cm]\n    & \\hfill{$\\nearrow$\\hspace*{-0.1cm}}     & {$\\uparrow$}      & {\\hspace*{-0.2cm}$\\nwarrow$} \\\\\n    & \\hfill{\\textbf{E}rror\\hspace*{0.2cm}}  & {\\textbf{T}rend}  & {\\hspace*{0.2cm}\\textbf{S}eason}\n\\end{tabular}\n\\end{block}\n\n\\alert{\\textbf{E}rror:} Additive (`\"A\"`) or multiplicative (`\"M\"`)\n\\pause\n\n\\alert{\\textbf{T}rend:} None (`\"N\"`), additive (`\"A\"`), multiplicative (`\"M\"`), or damped (`\"Ad\"` or `\"Md\"`).\n\\pause\n\n\\alert{\\textbf{S}easonality:} None (`\"N\"`), additive (`\"A\"`) or multiplicative (`\"M\"`)\n\n## ETS(A,N,A): No trend, additive seasonal model\n\n\\begin{block}{}\\vspace*{-0.8cm}\n\\begin{align*}\n\\text{State equations}&& \\ell_t&=\\ell_{t-1}+ \\alpha \\varepsilon_t\\\\\n&&s_t &= s_{t-m} + \\gamma\\varepsilon_t \\\\\n\\text{Observation equation}&& y_t&=\\ell_{t-1}+s_{t-m} + \\varepsilon_t\\\\\n\\text{Forecast equation} && \\hat{y}_{t+h|t} &= \\ell_{t} + s_{t+h-m(k+1)}\n\\end{align*}\n\\end{block}\n\n  * Forecast errors: $\\varepsilon_{t} = y_t - \\hat{y}_{t|t-1}\\sim\\text{NID}(0,\\sigma^2)$\n  * $k$ is integer part of $(h-1)/m$.\n\n\n## ETS(A,A,A): Holt-Winters additive method \n\n\\begin{block}{}\\vspace*{-0.8cm}\n\\begin{align*}\n\\text{State equations}&& \\ell_t&=\\ell_{t-1}+b_{t-1}+\\alpha \\varepsilon_t\\\\\n&&        b_t&=b_{t-1}+\\beta \\varepsilon_t \\\\\n&&s_t &= s_{t-m} + \\gamma\\varepsilon_t \\\\\n\\text{Observation equation}&& y_t&=\\ell_{t-1}+b_{t-1}+s_{t-m} + \\varepsilon_t\\\\\n\\text{Forecast equation} && \\hat{y}_{t+h|t} &= \\ell_{t} + hb_{t} + s_{t+h-m(k+1)}\n\\end{align*}\n\\end{block}\n\n  * Forecast errors: $\\varepsilon_{t} = y_t - \\hat{y}_{t|t-1}\\sim\\text{NID}(0,\\sigma^2)$\n  * $k$ is integer part of $(h-1)/m$.\n\n## ETS(M,A,M): Holt-Winters multiplicative method\n\n\\begin{block}{}\\vspace*{-0.8cm}\n\\begin{align*}\n\\text{State equations}&& \\ell_t&=(\\ell_{t-1}+b_{t-1})(1+\\alpha \\varepsilon_t)\\\\\n&&        b_t&=b_{t-1} +\\beta(\\ell_{t-1}+b_{t-1}) \\varepsilon_t \\\\\n&&s_t &= s_{t-m}(1 + \\gamma\\varepsilon_t) \\\\\n\\text{Observation equation}&& y_t&= (\\ell_{t-1}+b_{t-1})s_{t-m}(1 + \\varepsilon_t)\\\\\n\\text{Forecast equation} && \\hat{y}_{t+h|t} &= (\\ell_{t} + hb_{t}) s_{t+h-m(k+1)}\n\\end{align*}\n\\end{block}\n\n  * Relative forecast errors: $\\varepsilon_{t} = \\frac{y_t - \\hat{y}_{t|t-1}}{\\hat{y}_{t|t-1}} \\sim\\text{NID}(0,\\sigma^2)$\n  * $k$ is integer part of $(h-1)/m$.\n\n## All ETS models \n\\fontsize{11}{12}\\sf\n\n\\begin{block}{}\n\\begin{tabular}{ll|ccc}\n  \\multicolumn{2}{l}{\\alert{\\bf Additive Error}} &        \\multicolumn{3}{c}{\\bf Seasonal Component}         \\\\\n          \\multicolumn{2}{c|}{\\bf Trend}         &         N         &         A         &         M         \\\\\n        \\multicolumn{2}{c|}{\\bf Component}       &     ~(None)~      &    (Additive)     & (Multiplicative)  \\\\ \\cline{3-5}\n           &                                     &                   &                   &  \\\\[-0.4cm]\n  N        & (None)                              &       A,N,N       &       A,N,A       &    A,N,M     \\\\\n           &                                     &                   &                   &  \\\\[-0.4cm]\n  A        & (Additive)                          &       A,A,N       &       A,A,A       &    A,A,M     \\\\\n           &                                     &                   &                   &  \\\\[-0.4cm]\n  A\\damped & (Additive damped)                   &   A,A\\damped,N    &   A,A\\damped,A    & A,A\\damped,M\n\\end{tabular}\n\\end{block}\\pause\n\n\\begin{block}{}\n\\begin{tabular}{ll|ccc}\n  \\multicolumn{2}{l}{\\alert{\\bf Multiplicative Error}} &     \\multicolumn{3}{c}{\\bf Seasonal Component}      \\\\\n             \\multicolumn{2}{c|}{\\bf Trend}            &      N       &         A         &        M         \\\\\n           \\multicolumn{2}{c|}{\\bf Component}          &   ~(None)~   &    (Additive)     & (Multiplicative) \\\\ \\cline{3-5}\n           &                                           &              &                   &  \\\\[-0.4cm]\n  N        & (None)                                    &    M,N,N     &       M,N,A       &      M,N,M       \\\\\n           &                                           &              &                   &  \\\\[-0.4cm]\n  A        & (Additive)                                &    M,A,N     &       M,A,A       &      M,A,M       \\\\\n           &                                           &              &                   &  \\\\[-0.4cm]\n  A\\damped & (Additive damped)                         & M,A\\damped,N &   M,A\\damped,A    &   M,A\\damped,M\n\\end{tabular}\n\\end{block}\n\n\\vspace*{10cm}\n\n\n## Additive error models\n\n\\placefig{0}{1.5}{width=16.cm,trim=0 120 0 0,clip=true}{fig_7_ets_add.pdf}\n\n## Multiplicative error models\n\n\\placefig{0}{1.5}{width=16.cm,trim=0 120 0 0,clip=true}{fig_7_ets_multi.pdf}\n\n\n## Estimating ETS models\n\n  * Smoothing parameters $\\alpha$, $\\beta$, $\\gamma$ and $\\phi$, and the initial states $\\ell_0$, $b_0$, $s_0,s_{-1},\\dots,s_{-m+1}$ are estimated by maximising the \"likelihood\" = the probability of the data arising from the specified model.\n  * For models with additive errors equivalent to minimising SSE.\n  * For models with multiplicative errors, \\textbf{not} equivalent to minimising SSE.\n\n## Innovations state space models\n\nLet $\\bm{x}_t = (\\ell_t, b_t, s_t, s_{t-1}, \\dots, s_{t-m+1})$ and\n$\\varepsilon_t\\stackrel{\\mbox{\\scriptsize iid}}{\\sim}\n\\mbox{N}(0,\\sigma^2)$.\n\\begin{block}{}\n\\begin{tabular}{lcl}\n$y_t$ &=& $\\underbrace{h(\\bm{x}_{t-1})} +\n\\underbrace{k(\\bm{x}_{t-1})\\varepsilon_t}$\\\\\n&& \\hspace*{0.5cm}$\\mu_t$ \\hspace*{1.45cm} $e_t$ \\\\[0.2cm]\n$\\bm{x}_t$ &=& $f(\\bm{x}_{t-1}) +\ng(\\bm{x}_{t-1})\\varepsilon_t$\\\\\n\\end{tabular}\n\\end{block}\\fontsize{14}{16}\\sf\n\nAdditive errors\n: \\mbox{}\\vspace*{-0.cm}\\newline\n  $k(\\bm{x}_{t-1})=1$.\\qquad $y_t = \\mu_{t} + \\varepsilon_t$.\n\nMultiplicative errors\n: \\mbox{}\\vspace*{-0.cm}\\newline\n  $k(\\bm{x}_{t-1}) = \\mu_{t}$.\\qquad $y_t = \\mu_{t}(1 + \\varepsilon_t)$.\\newline\n  $\\varepsilon_t = (y_t - \\mu_t)/\\mu_t$ is relative error.\n\n## Innovations state space models\n\n\\alert{Estimation}\\vspace*{0.5cm}\n\n\\begin{block}{}\\vspace*{-0.7cm}\n\\begin{align*}\nL^*(\\bm\\theta,\\bm{x}_0) &= T\\log\\!\\bigg(\\sum_{t=1}^T \\varepsilon^2_t\\!\\bigg) + 2\\sum_{t=1}^T \\log|k(\\bm{x}_{t-1})|\\\\\n&= -2\\log(\\text{Likelihood}) + \\mbox{constant}\n\\end{align*}\n\\end{block}\n\n* Estimate parameters $\\bm\\theta = (\\alpha,\\beta,\\gamma,\\phi)$ and\ninitial states $\\bm{x}_0 = (\\ell_0,b_0,s_0,s_{-1},\\dots,s_{-m+1})$ by\nminimizing $L^*$.\n\n## Parameter restrictions\n\\fontsize{13}{14}\\sf\n\n### *Traditional* region\n\n* $0 < \\alpha < 1$\n* $0 < \\beta < \\alpha$\n* $0 < \\gamma < 1-\\alpha$\n* $0.8<\\phi<0.98$ --- to prevent numerical difficulties.\n\n### *Admissible* region\n\n  * To prevent observations in the distant past having a continuing effect on current forecasts\n  * Usually (but not always) less restrictive than *traditional* region\n  * e.g., ETS(A,N,N):  *traditional* $0< \\alpha <1$\\newline\\hspace*{3.1cm} *admissible* $0< \\alpha <2$\n\n\\only<2>{\\begin{textblock}{6}(8.8,.2)\n\\begin{alertblock}{}\n\\textbf{fable default}:\\newline intersection of both regions\n\\end{alertblock}\n\\end{textblock}}\n\n## Model selection\n\\fontsize{13}{14}\\sf\n\n\\begin{block}{Akaike's Information Criterion}\n\\[\n\\text{AIC} = -2\\log(\\text{L}) + 2k\n\\]\n\\end{block}\\vspace*{-0.2cm}\nwhere $L$ is the likelihood and $k$ is the number of parameters & initial states estimated in the model.\\pause\n\n\\begin{block}{Corrected AIC}\n\\[\n\\text{AIC}_{\\text{c}} = \\text{AIC} + \\frac{2k(k+1)}{T-k-1}\n\\]\n\\end{block}\\vspace*{-0.2cm}\nwhich is the AIC corrected (for small sample bias).\n\\pause\n\\begin{block}{Bayesian Information Criterion}\n\\[\n\\text{BIC} = \\text{AIC} + k[\\log(T)-2].\n\\]\n\\end{block}\n\n## AIC and cross-validation\n\n\\Large\n\n\\begin{alertblock}{}\nMinimizing the AIC assuming Gaussian residuals is asymptotically equivalent to minimizing one-step time series cross validation MSE.\n\\end{alertblock}\n\n\n## Automatic forecasting\n\n**From Hyndman et al.\\ (IJF, 2002):**\n\n* Apply each model that is appropriate to the data.\nOptimize parameters and initial values using MLE (or some other\ncriterion).\n* Select best method using AICc:\n* Produce forecasts using best method.\n* Obtain forecast intervals using underlying state space model.\n\nMethod performed very well in M3 competition.\n\n## Some unstable models\n\n* Some of the combinations of (Error, Trend, Seasonal) can lead to numerical difficulties; see equations with \\alert{division by a state}.\n* These are: ETS(A,N,M), ETS(A,A,M), ETS(A,A\\damped,M).\n\n## ETS models\n\\fontsize{11}{12}\\sf\n\n\\begin{block}{}\n\\begin{tabular}{ll|ccc}\n  \\multicolumn{2}{l}{\\alert{\\bf Additive Error}} &        \\multicolumn{3}{c}{\\bf Seasonal Component}         \\\\\n          \\multicolumn{2}{c|}{\\bf Trend}         &         N         &         A         &         M         \\\\\n        \\multicolumn{2}{c|}{\\bf Component}       &     ~(None)~      &    (Additive)     & (Multiplicative)  \\\\ \\cline{3-5}\n           &                                     &                   &                   &  \\\\[-0.4cm]\n  N        & (None)                              &       A,N,N       &       A,N,A       &    \\str{A,N,M}     \\\\\n           &                                     &                   &                   &  \\\\[-0.4cm]\n  A        & (Additive)                          &       A,A,N       &       A,A,A       &    \\str{A,A,M}     \\\\\n           &                                     &                   &                   &  \\\\[-0.4cm]\n  A\\damped & (Additive damped)                   &   A,A\\damped,N    &   A,A\\damped,A    & \\str{A,A\\damped,M}\n\\end{tabular}\n\\end{block}\n\n\\begin{block}{}\n\\begin{tabular}{ll|ccc}\n  \\multicolumn{2}{l}{\\alert{\\bf Multiplicative Error}} &     \\multicolumn{3}{c}{\\bf Seasonal Component}      \\\\\n             \\multicolumn{2}{c|}{\\bf Trend}            &      N       &         A         &        M         \\\\\n           \\multicolumn{2}{c|}{\\bf Component}          &   ~(None)~   &    (Additive)     & (Multiplicative) \\\\ \\cline{3-5}\n           &                                           &              &                   &  \\\\[-0.4cm]\n  N        & (None)                                    &    M,N,N     &       M,N,A       &      M,N,M       \\\\\n           &                                           &              &                   &  \\\\[-0.4cm]\n  A        & (Additive)                                &    M,A,N     &       M,A,A       &      M,A,M       \\\\\n           &                                           &              &                   &  \\\\[-0.4cm]\n  A\\damped & (Additive damped)                         & M,A\\damped,N &   M,A\\damped,A    &   M,A\\damped,M\n\\end{tabular}\n\\end{block}\n\n## Residuals\n\\vspace*{0.2cm}\n\n### Response residuals\n\\centerline{$\\hat{e}_t = y_t - \\hat{y}_{t|t-1}$}\n\n### Innovation residuals\nAdditive error model:\n\\centerline{$\\hat\\varepsilon_t = y_t - \\hat{y}_{t|t-1}$}\nMultiplicative error model:\n\\centerline{$\\hat\\varepsilon_t = \\frac{y_t - \\hat{y}_{t|t-1}}{\\hat{y}_{t|t-1}}$}\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}