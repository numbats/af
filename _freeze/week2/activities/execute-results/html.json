{
  "hash": "422db830aa33e1d1ffb0daec17f4e3d9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Activities: Week 2\"\neditor: source\nengine: knitr\nfilters:\n  - live\n  - quiz-teachr\nojs-engine: true\nwebr:\n  packages:\n    - qlcheckr\n    - fpp3\n    - urca\n    - forcats\n  autoload-packages: false\n  repos:\n    - https://repo.r-wasm.org/\n    - https://learnr-academy.github.io/qlcheckr\n---\n\n::: {.cell}\n\n:::\n\n\n## More R functions\n\n* `gg_season()` with `period` argument\n* `pivot_longer()`\n* `facet_grid()`\n* `GGally::ggpairs()`\n* `gg_lag()`\n* `ACF()`\n\n[R examples](workshop.R)\n\n::: {.cell}\n\n:::\n\n## Exercise 1: data exploration\n\nThe `nsw_offences` dataset contains monthly data on criminal offences in NSW  counts from January 1995 to December 2023.\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tsibble: 7,308 x 3 [1M]\n# Key:       Type [21]\n      Month Type                     Count\n      <mth> <chr>                    <dbl>\n 1 1995 Jan Abduction and kidnapping    15\n 2 1995 Feb Abduction and kidnapping    16\n 3 1995 Mar Abduction and kidnapping    23\n 4 1995 Apr Abduction and kidnapping    22\n 5 1995 May Abduction and kidnapping    14\n 6 1995 Jun Abduction and kidnapping    13\n 7 1995 Jul Abduction and kidnapping    19\n 8 1995 Aug Abduction and kidnapping    23\n 9 1995 Sep Abduction and kidnapping    13\n10 1995 Oct Abduction and kidnapping    21\n# â„¹ 7,298 more rows\n```\n\n\n:::\n:::\n\n#### How many types of offences are recorded?\n\n:::{.quiz-singlechoice}\n- [ ] [3]{hint=\"x\"}\n- [X] [21]{hint=\"o\"}\n- [ ] [7,308]{hint=\"x\"}\n- [ ] [7,298]{hint=\"x\"}\n- [ ] [Unknown]{hint=\"x\"}\n:::\n\n&nbsp;<br>\n\n#### Which is the most common?\n\n::: {.cell exercise='find_most_common_offence'}\n```{webr}\n#| exercise: find_most_common_offence\nnsw_offences |>\n  as_tibble() |>\n  group_by(Type) |>\n  summarise(______) |>\n  arrange(desc(______))\n```\n:::\n\n:::{.quiz-singlechoice}\n- [ ] [Abduction and kidnapping]{hint=\"x\"}\n- [ ] [Against justice procedures]{hint=\"x\"}\n- [ ] [Arson]{hint=\"x\"}\n- [ ] [Assault]{hint=\"x\"}\n- [ ] [Betting and gaming offences]{hint=\"x\"}\n- [ ] [Blackmail and extortion]{hint=\"x\"}\n- [ ] [Disorderly conduct]{hint=\"x\"}\n- [ ] [Drug offences]{hint=\"x\"}\n- [ ] [Homicide]{hint=\"x\"}\n- [ ] [Intimidation, stalking and harassment]{hint=\"x\"}\n- [ ] [Liquor offences]{hint=\"x\"}\n- [ ] [Malicious damage to property]{hint=\"x\"}\n- [ ] [Other offences]{hint=\"x\"}\n- [ ] [Other offences against the person]{hint=\"x\"}\n- [ ] [Pornography offences]{hint=\"x\"}\n- [ ] [Prohibited and regulated weapons offences]{hint=\"x\"}\n- [ ] [Prostitution offences]{hint=\"x\"}\n- [ ] [Robbery]{hint=\"x\"}\n- [ ] [Sexual offences]{hint=\"x\"}\n- [X] [Theft]{hint=\"\"}\n- [ ] [Transport regulatory offences]{hint=\"\"}\n:::\n\n#### Which is the least common?\n\n::: {.cell exercise='find_least_common_offence'}\n```{webr}\n#| exercise: find_least_common_offence\nnsw_offences |>\n  as_tibble() |>\n  group_by(Type) |>\n  summarise(______) |>\n  arrange(______)\n```\n:::\n\n:::{.quiz-singlechoice}\n- [ ] [Abduction and kidnapping]{hint=\"x\"}\n- [ ] [Against justice procedures]{hint=\"x\"}\n- [ ] [Arson]{hint=\"x\"}\n- [ ] [Assault]{hint=\"x\"}\n- [X] [Betting and gaming offences]{hint=\"o\"}\n- [ ] [Blackmail and extortion]{hint=\"x\"}\n- [ ] [Disorderly conduct]{hint=\"x\"}\n- [ ] [Drug offences]{hint=\"x\"}\n- [ ] [Homicide]{hint=\"x\"}\n- [ ] [Intimidation, stalking and harassment]{hint=\"x\"}\n- [ ] [Liquor offences]{hint=\"x\"}\n- [ ] [Malicious damage to property]{hint=\"x\"}\n- [ ] [Other offences]{hint=\"x\"}\n- [ ] [Other offences against the person]{hint=\"x\"}\n- [ ] [Pornography offences]{hint=\"x\"}\n- [ ] [Prohibited and regulated weapons offences]{hint=\"x\"}\n- [ ] [Prostitution offences]{hint=\"x\"}\n- [ ] [Robbery]{hint=\"x\"}\n- [ ] [Sexual offences]{hint=\"x\"}\n- [ ] [Theft]{hint=\"x\"}\n- [ ] [Transport regulatory offences]{hint=\"\"}\n:::\n\n## Exercise 2: autoplots\n\nTry using `autoplot()` on the `nsw_offences` dataset.\n\n::: {.cell exercise='autoplot'}\n```{webr}\n#| exercise: autoplot\nnsw_offences |>\n  autoplot(____)\n```\n:::\n\n#### What problems do you see? (Choose all that apply)\n\n:::{.quiz-multichoice}\n- [X] [It is cramped because of the large legend.]{hint=\"o\"}\n- [X] [It is hard to distinguish which line corresponds to which series because the colors are too similar.]{hint=\"o\"}\n- [ ] [It is hard to distinguish which series is which because the legend is too small.]{hint=\"x\"}\n- [X] [There is so much overplotting, you can't distinguish the lines.]{hint=\"o\"}\n:::\n\n#### Here is a graph that works a little better. Figure out what each line of code is doing.\n\n::: {.cell exercise='better_autoplot'}\n```{webr}\n#| exercise: better_autoplot\nnsw_offences |>\n  as_tibble() |>\n  mutate(Type = forcats::fct_lump_n(Type, 5, w=Count)) |>\n  group_by(Month, Type) |>\n  summarise(Count = sum(Count), .groups = \"drop\") |>\n  as_tsibble(index = Month, key = Type) |>\n  autoplot(Count) +\n  theme(legend.position = \"bottom\") +\n  scale_color_brewer(palette = \"Set2\")\n```\n:::\n\n#### Produce a time plot for \"Liquor offences\" using the `autoplot()` function.\n\n::: {.cell exercise='liquor_offences'}\n```{webr}\n#| exercise: liquor_offences\nnsw_offences |>\n  filter(____) |>\n  autoplot(____)\n```\n:::\n\nWhat do you think is causing the spikes around 2008-2011? What do you think is causing the troughs in 2020 and 2021?\n\n#### Produce a time plot combining all offences for each month.\n\n::: {.cell exercise='all_offences'}\n```{webr}\n#| exercise: all_offences\nnsw_offences |>\n  summarise(____) |>\n  autoplot(____)\n```\n:::\n\n#### One of the series has an outlier. Can you identify which one?\n\n::: {.cell exercise='outlier'}\n```{webr}\n#| exercise: outlier\noutlier_type <- nsw_offences |>\n  group_by(Type) |>\n  filter(___) |>\n  pull(Type)\n\nnsw_offences |>\n  filter(____) |>\n  autoplot(____)\n```\n:::\n\n::: {.callout-tip}\n### Hint\n\n* An outlier often has a large jump between observations.\n* The `difference()` function computes differences between consecutive observations.\n* When comparing values across groups, it is often better to use percentage changes rather than absolute changes.\n:::\n\n## Exercise 3: seasonal plots\n\n#### Produce a season plot to find which month contains the outlier\n\n::: {.cell exercise='assaults'}\n```{webr}\n#| exercise: assaults\nnsw_offences |>\n  filter(____) |>\n  gg_season(____)\n```\n:::\n\n#### Produce a season plot combining all offences for each month.\n\n::: {.cell exercise='all_offences_seasonality'}\n```{webr}\n#| exercise: all_offences_seasonality\nnsw_offences |>\n  summarise(____) |>\n  gg_season(____)\n```\n:::\n\nWhich month usually has the most offences in each year?\n\n#### Produce a subseries plot of assaults.\n\n::: {.cell exercise='all_offences_subseries'}\n```{webr}\n#| exercise: all_offences_subseries\n#| fig-height: 2.5\nnsw_offences |>\n  summarise(____) |>\n  gg_subseries(____)\n```\n:::\n\nWhich month has changed the most relative to the other months?\n\n## Exercise 4: cyclic data\n\nA famous data set containing cycles is the Canadian lynx data, contained in `pelts`.\n\n::: {.cell exercise='lynx'}\n```{webr}\n#| exercise: lynx\npelt |>\n  autoplot(____)\n```\n:::\n\nHow far apart are the peaks and troughs on average?\n\nProduce an ACF plot for the `Lynx` series.\n\n::: {.cell exercise='acf_lynx'}\n```{webr}\n#| exercise: acf_lynx\npelt |>\n  ACF(___) |>\n  autoplot(____)\n```\n:::\n\n* Why does the ACF peak around lag 10?\n* Why can't this data be seasonal?\n\n## Exercise 5: ACF plots\n\nWhich time plot corresponds to which ACF plot?\n\n::: {.cell}\n::: {.cell-output-display}\n![](activities_files/figure-html/acf-quiz-1.png){width=100%}\n:::\n:::\n\n\n::: columns\n\n::: {.column width=\"25%\"}\n\n#### Plot 1.\n:::{.quiz-singlechoice}\n- [ ] [A]{hint=\"x\"}\n- [X] [B]{hint=\"o\"}\n- [ ] [C]{hint=\"x\"}\n- [ ] [D]{hint=\"x\"}\n:::\n:::\n\n::: {.column width=\"25%\"}\n\n#### Plot 2.\n:::{.quiz-multichoice}\n- [X] [A]{hint=\"o\"}\n- [ ] [B]{hint=\"x\"}\n- [ ] [C]{hint=\"x\"}\n- [ ] [D]{hint=\"x\"}\n:::\n:::\n\n::: {.column width=\"25%\"}\n\n#### Plot 3.\n:::{.quiz-multichoice}\n- [ ] [A]{hint=\"x\"}\n- [ ] [B]{hint=\"x\"}\n- [ ] [C]{hint=\"x\"}\n- [X] [D]{hint=\"o\"}\n:::\n:::\n\n::: {.column width=\"25%\"}\n\n#### Plot 4.\n:::{.quiz-multichoice}\n- [ ] [A]{hint=\"x\"}\n- [ ] [B]{hint=\"x\"}\n- [X] [C]{hint=\"o\"}\n- [ ] [D]{hint=\"x\"}\n:::\n:::\n\n:::\n\n## Weekly quiz\n\n[Go to week 2 quiz](https://learning.monash.edu/mod/quiz/view.php?id=3868353)\n",
    "supporting": [
      "activities_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}