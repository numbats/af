{
  "hash": "ee5d45a76a3ecc3a37e0db518a8b6587",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Activities: Week 3\"\neditor: source\nengine: knitr\nfilters:\n  - live\n  - quiz-teachr\nojs-engine: true\nwebr:\n  packages:\n    - qlcheckr\n    - fpp3\n  autoload-packages: false\n  repos:\n    - https://repo.r-wasm.org/\n    - https://learnr-academy.github.io/qlcheckr\n---\n\n::: {.cell}\n\n:::\n\n\n\n## Was there a COVID baby boom in Victoria?\n\nThe first Melbourne COVID-19 lockdown was from 31 March 2020 to 12 May 2020. We are interested in whether more babies than usual were born 9 months later --- in January or February 2021.\n\nFirst extract the data for Victoria from the `aus_births` dataset.\n\n::: {.cell exercise='extract_data'}\n```{webr}\n#| exercise: extract_data\nvic_births <- fpp3::aus_births |>\n  ____(State == \"VIC\") |>\n  ____(-State)\nvic_births\n```\n:::\n\n::: {.cell context='setup'}\n```{webr}\n#| context: setup\n#| include: false\nvic_births <- fpp3::aus_births |>\n  filter(State == \"VIC\") |>\n  select(-State)\nvic_ave_births <- vic_births |>\n  mutate(Daily_average = Births / days_in_month(Month))\n```\n:::\n\nThis shows the number of births in Victoria each month from January 1975 to December 2021.\n\nNow produce a time plot and a season plot of the data, to better understand the trend and seasonal patterns.\n\n::: {.cell exercise='births_plots'}\n```{webr}\n#| exercise: births_plots\nvic_births |> ____(____)\nvic_births |> ____(____)\n```\n:::\n\nThe see-saw seasonal pattern is due to month length variation.\n\nSo let's remove it by taking the daily average of births in the month.\n\n::: {.cell exercise='daily_average'}\n```{webr}\n#| exercise: daily_average\nvic_ave_births <- vic_births |>\n  mutate(Daily_average = ____ / days_in_month(____))\nvic_ave_births\n```\n:::\n\nNow repeat the time and season plot, but using the daily average variable, rather than the monthly total.\n\n::: {.cell exercise='daily_average_plots'}\n```{webr}\n#| exercise: daily_average_plots\nvic_ave_births |> ____(____)\nvic_ave_births |> ____(____)\n```\n:::\n\n* Has the peak month for having babies changed compared to the previous `gg_season` plot? Why?\n* Why has the unusual fluctuation after January 2020 apparently increased in size compared to the previous `gg_season` plot?\n\nLet's do an STL decomposition. Experiment with the value of `window` and `robust` to see how the seasonal component changes over time. We need `robust  = TRUE` here, so the unusual behaviour near the end of the series does not have a strong effect on the trend or seasonal components\n\n::: {.cell exercise='stl'}\n```{webr}\n#| exercise: stl\ndmp <- vic_ave_births |>\n  model(stl = STL(Daily_average ~ season(window = ___), robust = ___))\ncomponents(dmp) |> autoplot()\n```\n:::\n\nWith your preferred values of `window` and `robust`, plot the remainder component\n\n::: {.cell exercise='remainder'}\n```{webr}\n#| exercise: remainder\ndmp <- vic_ave_births |>\n  model(stl = STL(Daily_average ~ season(window = ___), robust = ___))\ncomponents(dmp) |>\n  filter(Month >= yearmonth(\"2020 Jan\")) |>\n  autoplot(remainder)\n```\n:::\n\nOnce we remove the trend and seasonal component, and just look at the remainder, we can see any effects that are not simply seasonality or trend. Here we are plotting the remainder for the last year.\n\nHow many extra births per month than normal were there in February 2021?\n\n:::{.quiz-singlechoice}\n- [ ] [About 20]{hint=\"x\"}\n- [ ] [About 25]{hint=\"x\"}\n- [X] [About 800]{hint=\"o\"}\n- [ ] [It's impossible to tell from this graph]{hint=\"x\"}\n:::\n\n\n## Canadian gas production\n\nThis exercise uses the `canadian_gas` data (monthly Canadian gas production in billions of cubic metres, January 1960 â€“ February 2005).\n\nTry to find a Box-Cox transformation to stabilise the variance. Why isn't it possible?\n\n::: {.cell exercise='gas1'}\n```{webr}\n#| exercise: gas1\ncanadian_gas |>\n  autoplot(box_cox(Volume, ___))\n```\n:::\n\nWithout using a transformation, do a time plot, season plot and subseries plot to look at the effect of the changing seasonality over time.\n\n::: {.cell exercise='gas2'}\n```{webr}\n#| exercise: gas2\ncanadian_gas |> ___(___)\ncanadian_gas |> ___(___)\ncanadian_gas |> ___(___)\n```\n:::\n\nDo an STL decomposition of the data. You will need to choose a seasonal window to allow for the changing shape of the seasonal component.\n\n::: {.cell exercise='gas3'}\n```{webr}\n#| exercise: gas3\ncanadian_gas |>\n  model(STL(___ ~ season(window = ___))) |>\n  components() |>\n  autoplot()\n```\n:::\n\nHow does the seasonal shape change over time?\n\n::: {.cell exercise='gas4'}\n```{webr}\n#| exercise: gas4\nfit <- canadian_gas |>\n  model(STL(___ ~ season(window = ___))) |>\n  components()\nfit |> gg_subseries(___)\nfit |> gg_season(___)\n```\n:::\n\nCan you produce a plausible seasonally adjusted series?\n\n::: {.cell exercise='gas5'}\n```{webr}\n#| exercise: gas5\nfit <- canadian_gas |>\n  model(STL(___ ~ season(window = ___))) |>\n  components()\ncanadian_gas |>\n  autoplot(___) +\n  autolayer(fit, ___, col = \"blue\")\n```\n:::\n\n## Canberra public transport usage\n\n* Do Exam 2024, Question B2.\n",
    "supporting": [
      "activities_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}