{
  "hash": "6e1914f3acbb1484679cfe96fdf35a0c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: ETC3550/ETC5550 Applied forecasting\nauthor: \"Week 9: ARIMA models\"\nformat:\n  presentation-beamer:\n    knitr:\n      opts_chunk:\n        dev: \"cairo_pdf\"\n    pdf-engine: pdflatex\n    fig-width: 7.5\n    fig-height: 3.5\n    include-in-header: ../header.tex\n    keep_tex: yes\n---\n\n\n\n## Seasonal ARIMA models\n\n\\begin{center}\n\\begin{tabular}{rcc}\n\\toprule\nARIMA & $\\underbrace{(p, d, q)}$ & $\\underbrace{(P, D, Q)_{m}}$ \\\\\n\\midrule\n& $\\uparrow$ & $\\uparrow$ \\\\\n& Non-seasonal part & Seasonal part of \\\\\n& of the model & of the model \\\\\n\\bottomrule\n\\end{tabular}\n\nwhere $m =$ number of observations per year.\n\\end{center}\n\n\n\n## Seasonal ARIMA models\n\nE.g., ARIMA$(1, 1, 1)(1, 1, 1)_{4}$ model (without constant)\\pause\n$$(1 - \\phi_{1}B)(1 - \\Phi_{1}B^{4}) (1 - B) (1 - B^{4})y_{t} ~= ~\n(1 + \\theta_{1}B) (1 + \\Theta_{1}B^{4})\\varepsilon_{t}.\n$$\\pause\\vspace*{-1cm}\n\n\\setlength{\\unitlength}{1mm}\n\\begin{footnotesize}\n\\begin{picture}(100,25)(-5,0)\n\\thinlines\n{\\put(15,22){\\vector(0,1){6}}}\n{\\put(32,10){\\vector(0,1){18}}}\n{\\put(48,22){\\vector(0,1){6}}}\n{\\put(66,10){\\vector(0,1){18}}}\n{\\put(97,22){\\vector(0,1){6}}}\n{\\put(115,10){\\vector(0,1){18}}}\n{\\put(0,17){$\\left(\\begin{array}{@{}c@{}} \\text{Non-seasonal} \\\\ \\text{AR(1)}\n                    \\end{array}\\right)$}}\n{\\put(22,5){$\\left(\\begin{array}{@{}c@{}} \\text{Seasonal} \\\\ \\text{AR(1)}\n                    \\end{array}\\right)$}}\n{\\put(35,17){$\\left(\\begin{array}{@{}c@{}} \\text{Non-seasonal} \\\\ \\text{difference}\n                    \\end{array}\\right)$}}\n{\\put(55,5){$\\left(\\begin{array}{@{}c@{}} \\text{Seasonal} \\\\ \\text{difference}\n                    \\end{array}\\right)$}}\n{\\put(85,17){$\\left(\\begin{array}{@{}c@{}} \\text{Non-seasonal} \\\\ \\text{MA(1)}\n                    \\end{array}\\right)$}}\n{\\put(105,5){$\\left(\\begin{array}{@{}c@{}} \\text{Seasonal} \\\\ \\text{MA(1)}\n                    \\end{array}\\right)$}}\n\\end{picture}\n\\end{footnotesize}\n\n\\vspace*{10cm}\n\n## Seasonal ARIMA models\n\nE.g., ARIMA$(1, 1, 1)(1, 1, 1)_{4}$ model (without constant)\n$$(1 - \\phi_{1}B)(1 - \\Phi_{1}B^{4}) (1 - B) (1 - B^{4})y_{t} ~= ~\n(1 + \\theta_{1}B) (1 + \\Theta_{1}B^{4})\\varepsilon_{t}.\n$$\\vspace*{-1cm}\n\nAll the factors can be multiplied out and the general model\nwritten as follows:\\vspace*{-0.7cm}\n\\begin{align*}\ny_{t} &= (1 + \\phi_{1})y_{t - 1} - \\phi_1y_{t-2} + (1 + \\Phi_{1})y_{t - 4}\\\\\n&\\text{}\n - (1 + \\phi_{1} + \\Phi_{1} + \\phi_{1}\\Phi_{1})y_{t - 5}\n + (\\phi_{1} + \\phi_{1} \\Phi_{1}) y_{t - 6} \\\\\n& \\text{} - \\Phi_{1} y_{t - 8} + (\\Phi_{1} + \\phi_{1} \\Phi_{1}) y_{t - 9}\n  - \\phi_{1} \\Phi_{1} y_{t - 10}\\\\\n  &\\text{}\n  + \\varepsilon_{t} + \\theta_{1}\\varepsilon_{t - 1} + \\Theta_{1}\\varepsilon_{t - 4} + \\theta_{1}\\Theta_{1}\\varepsilon_{t - 5}.\n\\end{align*}\n\\vspace*{10cm}\n\n## Seasonal ARIMA models\nThe seasonal part of an AR or MA model will be seen in the seasonal lags of\nthe PACF and ACF.\n\n\\alert{ARIMA(0,0,0)(0,0,1)$_{12}$ will show:}\\vspace*{-0.2cm}\n\n  * a spike at lag 12 in the ACF but no other significant spikes.\n  * The PACF will show exponential decay in the seasonal lags; that is, at lags 12, 24, 36, \\dots.\n\n\\alert{ARIMA(0,0,0)(1,0,0)$_{12}$ will show:}\\vspace*{-0.2cm}\n\n  * exponential decay in the seasonal lags of the ACF\n  * a single significant spike at lag 12 in the PACF.\n\n\n## Point forecasts\n\n1. Rearrange ARIMA equation so $y_t$ is on LHS.\n2. Rewrite equation by replacing $t$ by $T+h$.\n3. On RHS, replace future observations by their forecasts, future errors by zero, and past errors by corresponding residuals.\n\nStart with $h=1$. Repeat for $h=2,3,\\dots$.\n\n## Prediction intervals\n\\fontsize{14}{15}\\sf\n\n\\begin{block}{95\\% prediction interval}\n$$\\hat{y}_{T+h|T} \\pm 1.96\\sqrt{v_{T+h|T}}$$\nwhere $v_{T+h|T}$ is estimated forecast variance.\n\\end{block}\\pause\\vspace*{-0.3cm}\n\n* $v_{T+1|T}=\\hat{\\sigma}^2$ for all ARIMA models regardless of parameters and orders.\\pause\n* Multi-step prediction intervals for ARIMA(0,0,$q$):\n\\centerline{$\\displaystyle y_t = \\varepsilon_t + \\sum_{i=1}^q \\theta_i \\varepsilon_{t-i}.$}\n\\centerline{$\\displaystyle\nv_{T|T+h} = \\hat{\\sigma}^2 \\left[ 1 + \\sum_{i=1}^{h-1} \\theta_i^2\\right], \\qquad\\text{for~} h=2,3,\\dots.$}\n\n## Prediction intervals\n\n* Prediction intervals **increase in size with forecast horizon**.\n* Prediction intervals can be difficult to calculate by hand\n* Calculations assume residuals are **uncorrelated** and **normally distributed**.\n* Prediction intervals tend to be too narrow.\n    * the uncertainty in the parameter estimates has not been accounted for.\n    * the ARIMA model assumes historical patterns will not change during the forecast period.\n    * the ARIMA model assumes uncorrelated future \\rlap{errors}\n\n\n## ARIMA vs ETS\n\\fontsize{14}{16}\\sf\n\n  * Myth that ARIMA models are more general than exponential smoothing.\n  * Linear exponential smoothing models all special cases of ARIMA models.\n  * Non-linear exponential smoothing models have no equivalent ARIMA counterparts.\n  * Many ARIMA models have no exponential smoothing counterparts.\n  * ETS models all non-stationary. Models with seasonality or non-damped trend (or both) have two unit roots; all other models have one unit \\rlap{root.}\n\n\\vspace*{10cm}\n\n## ARIMA vs ETS\n\n::: {.cell}\n::: {.cell-output-display}\n![](slides_files/figure-beamer/venn-1.pdf)\n:::\n:::\n\n## Equivalences\n\\fontsize{14}{15}\\sf\n\n|**ETS model**       | **ARIMA model**              | **Parameters**                        |\n| :------------      | :--------------------------  | :-----------------------------------  |\n| ETS(A,N,N)         | ARIMA(0,1,1)                 | $\\theta_1 = \\alpha-1$                 |\n| ETS(A,A,N)         | ARIMA(0,2,2)                 | $\\theta_1 = \\alpha+\\beta-2$           |\n|                    |                              | $\\theta_2 = 1-\\alpha$                 |\n| ETS(A,A\\damped,N)  | ARIMA(1,1,2)                 | $\\phi_1=\\phi$                         |\n|                    |                              | $\\theta_1 = \\alpha+\\phi\\beta-1-\\phi$  |\n|                    |                              | $\\theta_2 = (1-\\alpha)\\phi$           |\n| ETS(A,N,A)         | ARIMA(0,0,$m$)(0,1,0)$_m$    |                                       |\n| ETS(A,A,A)         | ARIMA(0,1,$m+1$)(0,1,0)$_m$  |                                       |\n| ETS(A,A\\damped,A)  | ARIMA(1,0,$m+1$)(0,1,0)$_m$  |                                       |\n\n: {tbl-colwidths=\"22,43,35\"}\n",
    "supporting": [
      "slides_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}