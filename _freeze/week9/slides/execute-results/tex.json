{
  "hash": "833e03c234bc3a1daa7671a53f81b25b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: ETC3550/ETC5550 Applied forecasting\nauthor: \"Week 8: ARIMA models\"\nformat:\n  presentation-beamer:\n    knitr:\n      opts_chunk:\n        dev: \"cairo_pdf\"\n    pdf-engine: pdflatex\n    fig-width: 7.5\n    fig-height: 3.5\n    include-in-header: ../header.tex\n    keep_tex: yes\n---\n\n\n\n\n\n# Random walks\n\n## Random walk model\n\nIf differenced series is white noise with zero mean:\n\n\\begin{block}{}\n\\centerline{$y_t-y_{t-1}=\\varepsilon_t$ \\hspace{0.4cm} or \\hspace{0.4cm} $y_t=y_{t-1}+\\varepsilon_t$}\n\\end{block}\\vspace*{-0.3cm}\nwhere $\\varepsilon_t \\sim NID(0,\\sigma^2)$.\n\n* Model behind the \\alert{na√Øve method}.\n* Forecast are equal to the last observation (future movements up or down are equally likely).\n\n\\vspace*{10cm}\n\n## Random walk model\n\n\\begin{block}{}\n\\centerline{$y_t=y_{t-1}+\\varepsilon_t$ \\qquad\nwhere $\\varepsilon_t \\sim NID(0,\\sigma^2)$.}\n\\end{block}\\pause\n\\vspace*{-1.3cm}\n\\begin{align*}\ny_{T+h} &= y_{T+h-1} + \\varepsilon_{T+h} \\\\\n  &= y_{T+h-2} + \\varepsilon_{T+h-1} + \\varepsilon_{T+h} \\\\\n  &= \\dots \\\\\n  &= y_T + \\varepsilon_{T+1} + \\dots + \\varepsilon_{T+h}\n\\end{align*}\n\\pause\\vspace*{-1cm}\n\\begin{align*}\n\\text{So}\\qquad &\\text{E}(y_{T+h}|y_1,\\dots,y_T)  = y_T \\\\\n\\text{and}\\qquad &\\text{Var}(y_{T+h}|y_1,\\dots,y_T) = h\\sigma^2\n\\end{align*}\\vspace*{10cm}\n\n## Random walk with drift model\n\nIf differenced series is white noise with non-zero mean:\n\n\\begin{block}{}\n\\centerline{$y_t-y_{t-1}=c+\\varepsilon_t$ \\hspace{0.4cm} or \\hspace{0.4cm} $y_t=c+y_{t-1}+\\varepsilon_t$}\n\\end{block}\\vspace*{-0.3cm}\nwhere $\\varepsilon_t \\sim NID(0,\\sigma^2)$.\n\n* $c$ is the \\alert{average change} between consecutive observations.\n* Model behind the \\alert{drift method}.\n\n\\vspace*{10cm}\n\n# Backshift operator notation\n\n## Backshift operator notation\n\n* $B$ shifts the data back one period. $B y_{t} = y_{t - 1}$\n* $B^2$ shifts the data back two periods: $B(By_{t}) = B^{2}y_{t} = y_{t-2}$\n* A difference can be written as $(1 - B) y_{t}$\n* A $d$th-order difference can be written as $(1 - B)^{d} y_{t}$\n* A seasonal difference followed by a first difference can be written as\n$(1-B)(1-B^m)y_t$\n\n# Autoregressive (AR) models\n\n## AR(1) model\n\n\\begin{block}{}\n  \\centerline{$y_{t} = c + \\phi_1 y_{t - 1} + \\varepsilon_{t}$}\n  \\centerline{$(1-\\phi_1B)y_{t} = c + \\varepsilon_{t}$}\n\\end{block}\n\n* When $\\phi_1=0$, $y_t$ is **equivalent to WN** (with mean $c$)\n* When $\\phi_1=1$ and $c=0$, $y_t$ is **equivalent to a RW**\n* When $\\phi_1=1$ and $c\\ne0$, $y_t$ is **equivalent to a RW with drift**\n* When $\\phi_1<0$, $y_t$ tends to **oscillate between positive and negative values**.\n\n## Autoregressive models\n\nA multiple regression with \\textbf{lagged values} of $y_t$ as predictors.\n\n\\vspace*{-1.2cm}\n\\begin{align*}\ny_t &= c + \\phi_{1}y_{t - 1} + \\phi_{2}y_{t - 2} + \\cdots + \\phi_{p}y_{t - p} + \\varepsilon_{t} \\\\\n&= c + (\\phi_1 B + \\phi_2 B^2 + \\cdots + \\phi_p B^p)y_t + \\varepsilon_t\n\\end{align*}\\pause\\vspace*{-1.2cm}\n\\begin{align*}\n(1 - \\phi_1 B - \\phi_2 B^2 - \\cdots - \\phi_p B^p)y_t &= c + \\varepsilon_t \\\\\n\\phi(B) y_t &= c+\\varepsilon_t\n\\end{align*}\n\n* $\\varepsilon_t$ is white noise.\n* $\\phi(B) = (1 - \\phi_1 B - \\phi_2 B^2 - \\cdots - \\phi_p B^p)$\n\n## Stationarity conditions\n\nWe normally restrict autoregressive models to stationary data, and then some constraints on the parameters are needed.\n\n\\begin{block}{General condition for stationarity}\n  Complex roots of $\\phi(z) = 1-\\phi_1 z - \\phi_2 z^2 - \\dots - \\phi_pz^p$ lie outside the unit circle on the complex plane.\n\\end{block}\\pause\\vspace*{-0.3cm}\n\n* For $p=1$: $-1<\\phi_1<1$.\n* For $p=2$: $-1<\\phi_2<1\\qquad \\phi_2+\\phi_1 < 1 \\qquad \\phi_2 -\\phi_1 < 1$.\n* More complicated conditions hold for $p\\ge3$.\n* fable takes care of this.\n\n# Moving Average (MA) models\n\n## Moving Average (MA) models\nA multiple regression with \\textbf{past \\emph{errors}} as predictors.\n\n\n\\vspace*{-1.2cm}\n\\begin{align*}\n  y_{t} &= c + \\varepsilon_t + \\theta_{1}\\varepsilon_{t - 1} + \\theta_{2}\\varepsilon_{t - 2} + \\cdots + \\theta_{q}\\varepsilon_{t - q}\\\\\n&= c + (1 + \\theta_1 B + \\theta_2 B^2 + \\cdots + \\theta_q B^q)\\varepsilon_t \\\\\n&= c + \\theta(B)\\varepsilon_t\n\\end{align*}\\pause\\vspace*{-1.2cm}\n\n* $\\varepsilon_t$ is white noise.\n* $\\theta(B) = (1 + \\theta_1 B + \\theta_2 B^2 + \\cdots + \\theta_q B^q)$\n\n## Invertibility\n\n\\begin{block}{General condition for invertibility}\n  Complex roots of $\\theta(z) = 1+\\theta_1 z + \\theta_2 z^2 + \\dots + \\theta_qz^q$ lie outside the unit circle on the complex plane.\n\\end{block}\\pause\n\n* For $q=1$: $-1<\\theta_1<1$.\n* For $q=2$: $-1<\\theta_2<1\\qquad \\theta_2+\\theta_1 >-1 \\qquad \\theta_1 -\\theta_2 < 1$.\n* More complicated conditions hold for $q\\ge3$.\n* fable takes care of this.\n\n# ARIMA models\n## ARIMA models\n\n\\fontsize{14}{14.5}\\sf\\vspace*{0.2cm}\n\\begin{block}{ARIMA($p, d, q$) model:\\qquad $\\phi(B)(1-B)^dy_{t} = c + \\theta(B)\\varepsilon_{t}$}\n\\begin{tabular}{rl}\nAR:& $p =$ order of the autoregressive part\\\\\nI: & $d =$ degree of first differencing involved\\\\\nMA:& $q =$ order of the moving average part.\n\\end{tabular}\n\\end{block}\\pause\\vspace*{-0.2cm}\n\n* Conditions on AR coefficients ensure stationarity.\n* Conditions on MA coefficients ensure invertibility.\n* White noise model: ARIMA(0,0,0)\n* Random walk: ARIMA(0,1,0) with no constant\n* Random walk with drift: ARIMA(0,1,0) with \\rlap{const.}\n* AR($p$): ARIMA($p$,0,0)\n* MA($q$): ARIMA(0,0,$q$)\n\n\n## R model\n\\vspace*{0.2cm}\n\n\\begin{block}{Intercept form}\n  \\centerline{$(1-\\phi_1B - \\cdots - \\phi_p B^p) y_t' = c + (1 + \\theta_1 B + \\cdots + \\theta_q B^q)\\varepsilon_t$}\n\\end{block}\n\n\\begin{block}{Mean form}\n  \\centerline{$(1-\\phi_1B - \\cdots - \\phi_p B^p)(y_t' - \\mu) = (1 + \\theta_1 B + \\cdots + \\theta_q B^q)\\varepsilon_t$}\n\\end{block}\n\n * $y_t' = (1-B)^d y_t$\n * $\\mu$ is the mean of $y_t'$.\n * $c = \\mu(1-\\phi_1 - \\cdots - \\phi_p )$.\n * fable uses intercept form\n\n## Understanding ARIMA models\n\\fontsize{14}{15}\\sf\n\n* If $c=0$ and $d=0$, the long-term forecasts will go to zero.\n* If $c=0$ and $d=1$, the long-term forecasts will go to a non-zero constant.\n* If $c=0$ and $d=2$, the long-term forecasts will follow a straight line.\n* If $c\\ne0$ and $d=0$, the long-term forecasts will go to the mean of the data.\n* If $c\\ne0$ and $d=1$, the long-term forecasts will follow a straight line.\n* If $c\\ne0$ and $d=2$, the long-term forecasts will follow a quadratic trend.\n\n## Understanding ARIMA models\n\\fontsize{14}{15}\\sf\n\n### Forecast variance and $d$\n  * The higher the value of $d$, the more rapidly the prediction intervals increase in size.\n  * For $d=0$, the long-term forecast standard deviation will go to the standard deviation of the historical data.\n\n### Cyclic behaviour\n  * For cyclic forecasts, $p\\ge2$ and some restrictions on coefficients are required.\n  * If $p=2$, we need $\\phi_1^2+4\\phi_2<0$. Then average cycle of length\n\n\\centerline{$(2\\pi)/\\left[\\text{arc cos}(-\\phi_1(1-\\phi_2)/(4\\phi_2))\\right].$}\n\n## Exercise\n\n\n* Find an ARIMA model for the `pelt::Lynx` data\n",
    "supporting": [
      "slides_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}