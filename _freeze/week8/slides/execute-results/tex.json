{
  "hash": "d00a9924f0d7572a7e41e28cc08b71ab",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: ETC3550/ETC5550 Applied forecasting\nauthor: \"Week 8: ARIMA models\"\nformat:\n  presentation-beamer:\n    knitr:\n      opts_chunk:\n        dev: \"cairo_pdf\"\n    pdf-engine: pdflatex\n    fig-width: 7.5\n    fig-height: 3.5\n    include-in-header: ../header.tex\n    keep_tex: yes\n---\n\n\n\n# ARIMA models\n\n## ARIMA models\n\n\\begin{tabular}{@{}rl}\n\\textbf{AR}: & autoregressive (lagged observations as inputs)\\\\\n\\textbf{I}: & integrated (differencing to make series stationary)\\\\\n\\textbf{MA}: & moving average (lagged errors as inputs)\n\\end{tabular}\n\n###\nAn ARIMA model is rarely interpretable in terms of visible data structures like trend and seasonality. But it can capture a huge range of time series patterns.\n\n# Stationarity\n\n## Stationarity\n\\fontsize{14}{16}\\sf\n\\begin{block}{Definition}\nIf $\\{y_t\\}$ is a stationary time series, then for all $s$, the distribution of $(y_t,\\dots,y_{t+s})$ does not depend on $t$.\n\\end{block}\\pause\\vspace*{-0.3cm}\n\nTransformations help to **stabilize the variance**.\\newline\nFor ARIMA modelling, we also need to **stabilize the mean**.\n\n## Non-stationarity in the mean\n\\alert{Identifying non-stationary series}\n\n* time plot.\n* The ACF of stationary data drops to zero relatively quickly\n* The ACF of non-stationary data decreases slowly.\n* For non-stationary data, the value of $r_1$ is often large and positive.\n\n# Differencing\n\n### Differencing\n\n* Differencing helps to **stabilize the mean**.\n* First differencing: *change* between consecutive observations: $y'_t = y_t - y_{t-1}$.\n* Seasonal differencing: *change* between years: $y'_t = y_t - y_{t-m}$.\n* Sometimes two differences need to be applied (but never more).\n\n## Automatic differencing\n\\fontsize{13}{16}\\sf\nStatistical tests to determine the required order of differencing.\n\n  1. Augmented Dickey Fuller test: null hypothesis is that the data are \\alert{non-stationary} and non-seasonal.\n  2. Kwiatkowski-Phillips-Schmidt-Shin (KPSS) test: null hypothesis is that the data are \\alert{stationary} and non-seasonal.\n\n\\only<2>{\\begin{textblock}{4}(10.2,2.7)\n\\begin{alertblock}{}\nH$_0$: non-stationary\n\\end{alertblock}\n\\end{textblock}}\n\n\\only<2>{\\begin{textblock}{3}(12.4,4.05)\n\\begin{alertblock}{}\nH$_0$: stationary\n\\end{alertblock}\n\\end{textblock}}\n\n### Seasonal strength\n\nSTL decomposition: $y_t = T_t+S_t+R_t$\n\nSeasonal strength $F_s = \\max\\big(0, 1-\\frac{\\text{Var}(R_t)}{\\text{Var}(S_t+R_t)}\\big)$\n\nIf $F_s > 0.64$, do one seasonal difference.\n\n## R commands\n\n* Lag 1 difference:\\hfill `difference(y)`\n* Seasonal difference:\\hfill `difference(y, lag = 4)`\n* KPSS test:\\hfill `unitroot_kpss(y)`\n* Seasonal strength:\\hfill `feat_stl(y, .period = 4)`\n* Automatic first differencing:\\hfill `unitroot_ndiffs(y)`\n* Automatic seasonal differencing:\\newline\\mbox{}\\hfill `unitroot_nsdiffs(y, .period = 4)`\n\n## Relationship to random walks\n\nA random walk is the process:\n$$y_t = y_{t-1} + \\varepsilon_t$$\nwhere $\\varepsilon_t$ is a white noise variable.\n\nSo if data did come from such a process, differencing would give white noise:\n$$y_t - y_{t-1} = \\varepsilon_t$$\n\n## Relationship to random walks\n\nA seasonal random walk is the process\n$$y_t = y_{t-m} + \\varepsilon_t$$\nwhere $\\varepsilon_t$ is a white noise variable.\n\nSo if data did come from such a process, seasonal differencing would give white noise:\n$$y_t - y_{t-m} = \\varepsilon_t$$\n\n## Relationship to random walk with drift\n\nA random walk with drift is the process:\n$$y_t = c + y_{t-1} + \\varepsilon_t$$\nwhere $\\varepsilon_t$ is a white noise variable.\n\nSo if data did come from such a process, differencing would give white noise with non-zero mean\n$$y_t - y_{t-1} = c + \\varepsilon_t$$\\vspace*{-1cm}\n\n* $c$ is the \\alert{average change} between consecutive \\rlap{observations.}\n\n\n## Backshift operator notation\n\n* $B$ shifts the data back one period. $B y_{t} = y_{t - 1}$\n* $B^2$ shifts the data back two periods: $B(By_{t}) = B^{2}y_{t} = y_{t-2}$\n* A difference can be written as $(1 - B) y_{t}$\n* A $d$th-order difference can be written as $(1 - B)^{d} y_{t}$\n* A seasonal difference followed by a first difference can be written as\n$(1-B)(1-B^m)y_t$\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}