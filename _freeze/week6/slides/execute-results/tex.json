{
  "hash": "cb5029f09d16acfef66f12d9b13211f2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: ETC3550/ETC5550 Applied forecasting\nauthor: \"Week 6: Non-seasonal exponential smoothing\"\nformat:\n  presentation-beamer:\n    knitr:\n      opts_chunk:\n        dev: \"cairo_pdf\"\n    pdf-engine: pdflatex\n    fig-width: 7.5\n    fig-height: 3.5\n    include-in-header: ../header.tex\n    keep_tex: yes\n---\n\n\n\n## Historical perspective\n\\fontsize{13}{15}\\sf\n\n * Developed in the 1950s and 1960s as methods (algorithms) to produce point forecasts.\n * Combine a \"level\", \"trend\" (slope) and \"seasonal\" component to describe a time series.\n * The rate of change of the components are controlled by \"smoothing parameters\": $\\alpha$, $\\beta$ and $\\gamma$ respectively.\n  * Need to choose best values for the smoothing parameters (and initial states).\n  * Equivalent ETS state space models developed in the 1990s and 2000s.\n  * ETS and the PBS\n\n## ETS models\n\\Large\n\n**E**xponen**T**ial **S**moothing\\newline\n**E**rror **T**rend **S**easonal\n\n\\pause\\normalsize\n\n**Error**: Additive, Multiplicative\\newline\n**Trend**: None, Additive, Additive damped\\newline\n**Seasonal**: None, Additive, Multiplicative\n\n\\pause\\fontsize{12}{13}\\sf\n\n* ETS(A,N,N): **A**dditive Error, **N**o Trend, **N**o Seasonality\\pause\n* ETS(M,A,N): **M**ultiplicative Error, **A**dditive Trend, **N**o Seasonality\\pause\n* ETS(M,A,M): **M**ultiplicative Error, **A**dditive Trend, **M**ultiplicative Seasonality\n\netc\n\n## ETS(A,N,N): SES with additive errors\n\n\\begin{block}{}\\vspace*{-0.8cm}\n\\begin{align*}\n\\text{State equation}      && \\ell_t          &= \\ell_{t-1}+\\alpha \\varepsilon_t\\\\\n\\text{Observation equation}&& y_t             &= \\ell_{t-1} + \\varepsilon_t\\\\\n\\text{Forecast equation}   && \\hat{y}_{t+h|t} &= \\ell_t\n\\end{align*}\n\\end{block}\\pause\n\n  * Forecast errors: $\\varepsilon_{t} = y_t - \\hat{y}_{t|t-1} \\sim\\text{NID}(0,\\sigma^2)$\n  * \"innovations\" or \"single source of error\" because equations have the same error process, $\\varepsilon_t$.\n\n## ETS(A,N,N): SES with additive errors\n\nNote that  $\\varepsilon_{t} = y_{t} - \\ell_{t-1}$. So\\vspace*{-0.2cm}\n\\begin{align*}\n\\hat{y}_{t+1|t} = \\ell_t & = \\ell_{t-1} + \\alpha \\varepsilon_t \\\\\n & = \\ell_{t-1} + \\alpha(y_t - \\ell_{t-1}) \\\\\n & = \\alpha y_{t} + (1 - \\alpha)\\ell_{t-1}  \\\\\n & = \\alpha y_{t} + (1 - \\alpha)[\\alpha y_{t-1} + (1-\\alpha) \\ell_{t-2}] \\\\\n & = \\alpha y_{t} + \\alpha(1 - \\alpha) y_{t-1} + (1-\\alpha)^2 \\ell_{t-2} \\\\\n & \\dots \\\\\n & = \\alpha \\sum_{j=0}^{t-1} (1-\\alpha)^j y_{t-j} + (1-\\alpha)^{t} \\ell_{0}\n \\end{align*}\n\n\n## ETS(A,N,N): SES with additive errors\n\\fontsize{13}{15}\\sf\n\nNote that  $\\ell_{t} = \\ell_{t-1} + \\alpha \\varepsilon_{t}$. So\\vspace*{-0.2cm}\n  \\begin{align*}\n     y_{T+h} & = \\ell_{T+h-1} + \\varepsilon_{T+h} \\\\\n             & = \\ell_{T+h-2} + \\alpha \\varepsilon_{T+h-1} +  \\varepsilon_{T+h} \\\\\n             & = \\ell_{T+h-3} + \\alpha \\varepsilon_{T+h-2}  + \\alpha \\varepsilon_{T+h-1} +  \\varepsilon_{T+h} \\\\\n             & \\dots \\\\\n             & = \\ell_{T} + \\alpha \\sum_{j=1}^{h-1} \\varepsilon_{T+h-j} +  \\varepsilon_{T+h}.\n  \\end{align*}\n$$             \n    \\text{Therefore\\quad}\\text{Var}(y_{T+h} | y_1,\\dots,y_T) \n      = \\alpha^2 \\sum_{j=1}^{h-1} \\sigma^2 +  \\sigma^2 \n      =  \\sigma^2\\left[ 1 + \\alpha^2 (h-1)\\right ].\n$$\n\n\n## ETS(A,A,N): Holt's method with additive errors\n\n\\begin{block}{}\\vspace*{-0.8cm}\n  \\begin{align*}\n\\text{State equations}&&   \\ell_t&=\\ell_{t-1}+b_{t-1}+\\alpha \\varepsilon_t\\\\\n      && b_t&=b_{t-1}+ \\beta \\varepsilon_t\\\\\n      \\text{Observation equation}&& y_t&=\\ell_{t-1}+b_{t-1}+\\varepsilon_t\\\\\n\\text{Forecast equation} &&       \\hat{y}_{t+h|t} &= \\ell_{t} + h b_t\n  \\end{align*}\n\\end{block}\n\n  * Forecast errors: $\\varepsilon_{t} = y_t - \\hat{y}_{t|t-1} \\sim\\text{NID}(0,\\sigma^2)$\n\n## ETS(M,N,N): SES with multiplicative errors.\n\n\\begin{block}{}\\vspace*{-0.8cm}\n\\begin{align*}\n\\text{State equation}&& \\ell_t              & = \\ell_{t-1}(1+\\alpha \\varepsilon_t)\\\\\n\\text{Observation equation}&& y_t           & = \\ell_{t-1}(1 + \\varepsilon_t)\\\\\n\\text{Forecast equation} && \\hat{y}_{t+h|t} & = \\ell_t\n\\end{align*}\n\\end{block}\n\n  * Relative forecast errors: $\\varepsilon_{t}=\\frac{y_t-\\pred{y}{t}{t-1}}{\\pred{y}{t}{t-1}} \\sim\\text{NID}(0,\\sigma^2)$\n  * Same point forecasts as ETS(A,N,N) with additive errors and same $\\alpha$.\n  * Different prediction intervals from ETS(A,N,N).\n\n## ETS(M,A,N): Holt's method with multiplicative errors.\n\n\\begin{block}{}\\vspace*{-0.8cm}\n  \\begin{align*}\n      \\text{State equations}&&\\ell_t&=(\\ell_{t-1}+b_{t-1})(1+\\alpha \\varepsilon_t)\\\\\n      &&b_t&=b_{t-1}+\\beta(\\ell_{t-1}+b_{t-1}) \\varepsilon_t\\\\\n      \\text{Observation equation}&&y_t&=(\\ell_{t-1}+b_{t-1})(1+\\varepsilon_t)\\\\\n\\text{Forecast equation} &&        \\hat{y}_{t+h|t} &= \\ell_{t} + h b_t\n  \\end{align*}\n\\end{block}\n\n  * Relative forecast errors: $\\varepsilon_{t}=\\frac{y_t-\\pred{y}{t}{t-1}}{\\pred{y}{t}{t-1}} \\sim\\text{NID}(0,\\sigma^2)$\n  * Same point forecasts as ETS(A,A,N) with additive errors and same $\\alpha$ and $\\beta$\n  * Different prediction intervals from ETS(A,A,N).\n\n## Summary of models so far\n\n**Simple exponential smoothing**\n\nETS(A,N,N) -- additive errors\n\nETS(M,N,N) -- multiplicative errors\n\n**Holt's linear trend method**\n\nETS(A,A,N) -- additive errors, additive trend\n\nETS(M,A,N) -- multiplicative errors, additive trend\n\n\n## ETS(A,Ad,N): Damped trend with additive errors\n\n\\begin{block}{}\\vspace*{-0.8cm}\n  \\begin{align*}\n\\text{State equations}&&   \\ell_t&=\\ell_{t-1}+\\phi b_{t-1}+\\alpha \\varepsilon_t\\\\\n      && b_t & = \\phi b_{t-1}+ \\beta \\varepsilon_t\\\\\n      \\text{Observation equation}&& y_t&=\\ell_{t-1}+\\phi b_{t-1}+\\varepsilon_t\\\\\n\\text{Forecast equation} &&       \\hat{y}_{t+h|t} &= \\ell_{t} + (\\phi + \\phi^2 + \\dots + \\phi^{h}) b_t\n  \\end{align*}\n\\end{block}\n\n  * Forecast errors: $\\varepsilon_{t} = y_t - \\hat{y}_{t|t-1} \\sim\\text{NID}(0,\\sigma^2)$\n  * Damping parameter $0<\\phi<1$.\n  * If $\\phi=1$, identical to Holt's linear trend.\n  * As $h\\rightarrow\\infty$, $\\pred{y}{T+h}{T}\\rightarrow \\ell_T+\\phi b_T/(1-\\phi)$.\n  * Short-run forecasts trended, long-run forecasts constant.\n\n\n## ETS(M,Ad,N): Damped trend with multiplicative errors\n\n\\begin{block}{}\\vspace*{-0.8cm}\n  \\begin{align*}\n\\text{State equations}&&   \\ell_t&=(\\ell_{t-1}+\\phi b_{t-1})(1+\\alpha \\varepsilon_t)\\\\\n      && b_t & = \\phi b_{t-1}+ \\beta (\\ell_{t-1}+\\phi b_{t-1})\\varepsilon_t\\\\\n      \\text{Observation equation}&& y_t&=(\\ell_{t-1}+\\phi b_{t-1})(1+\\varepsilon_t)\\\\\n\\text{Forecast equation} &&       \\hat{y}_{t+h|t} &= \\ell_{t} + (\\phi + \\phi^2 + \\dots + \\phi^{h}) b_t\n  \\end{align*}\n\\end{block}\n\n  * Relative forecast errors: $\\varepsilon_{t}=\\frac{y_t-\\pred{y}{t}{t-1}}{\\pred{y}{t}{t-1}} \\sim\\text{NID}(0,\\sigma^2)$\n  * Damping parameter $0<\\phi<1$.\n  * If $\\phi=1$, identical to Holt's linear trend.\n  * As $h\\rightarrow\\infty$, $\\pred{y}{T+h}{T}\\rightarrow \\ell_T+\\phi b_T/(1-\\phi)$.\n  * Short-run forecasts trended, long-run forecasts constant.\n\n\n## Non-seasonal ETS models\n\\fontsize{14}{15}\\sf\n\n**Simple exponential smoothing**\n\nETS(A,N,N) -- additive errors\n\nETS(M,N,N) -- multiplicative errors\n\n**Holt's linear trend method**\n\nETS(A,A,N) -- additive errors, additive trend\n\nETS(M,A,N) -- multiplicative errors, additive trend\n\n**Damped trend method**\n\nETS(A,Ad,N) -- additive errors, damped trend\n\nETS(M,Ad,N) -- multiplicative errors, damped trend\n\n\n## Parameters\n\\fontsize{14}{15}\\sf\n\n$\\alpha$ controls the flexibility of the **level**\n\n* If $\\alpha = 0$, the level never updates (mean)\n* If $\\alpha = 1$, the level updates completely (naive)\n\n$\\beta$ controls the flexibility of the **trend**\n\n* If $\\beta = 0$, the trend is linear\n* If $\\beta = 1$, the trend changes suddenly every observation\n\n$\\phi$ controls the rate of **damping**\n\n* If $\\phi = 1$, there is no damping (trend is linear)\n* If $0 < \\phi < 1$, the trend converges to constant\n\n## States\n\\fontsize{14}{15}\\sf\n\n$\\ell_t=$  level at time $t$\n\n$b_t =$ slope at time $t$",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}